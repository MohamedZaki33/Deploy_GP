<!DOCTYPE html>
<html>
<head>
	<title>Job Recommendation and Filtering System</title>
	<!-- Libraries Stylesheet -->
    <link href="{{ url_for('serve_static', path='lib/animate/animate.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('serve_static', path='lib/owlcarousel/assets/owl.carousel.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('serve_static', path='lib/lightbox/css/lightbox.min.css') }}" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="{{ url_for('serve_static', path='css/bootstrap.min.css') }}" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link rel="stylesheet" href="{{ url_for('serve_static', path='css/style.css') }}">
</head>
<style>
   .container {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }


  .input-container {
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    margin-bottom: 10px;
  }

  .input-container label {
    margin-right: 10px;
  }

  .bar-container {
    width: 40%;
    display: flex;
    justify-content: flex-end;
  }

  .bar {
    max-width: 100%;
    height: auto;
  }

  @media (max-width: 768px) {
    .container {
      flex-direction: column;
      align-items: center;
    }

    .form-container {
      width: 100%;
    }

    .bar-container {
      width: 100%;
      margin-top: 20px;
      justify-content: center;
    }
  }
     .icon-bar {
		width: 100%; /* Full-width */
		background-color: rgba(98, 34, 204, .9); /* Dark-grey background */
		overflow: auto; /* Overflow due to float */
		}

		.icon-bar a {
		float: left; /* Float links side by side */
		text-align: center; /* Center-align text */
		width: 10%; /* Equal width (5 icons with 20% width each = 100%) */
		padding: 1px 0; /* Some top and bottom padding */
		transition: all 0.3s ease; /* Add transition for hover effects */
		color: white; /* White text color */
		font-size: 36px; /* Increased font size */
		}
    .icon-bar a:hover {
		background-color: rgba(98, 34, 204, .9); /* Add a hover color */
		}

		.active {
		background-color: rgba(255, 255, 255, .1); /* Add an active/current color */
		}
</style>
<body>
 <div class="container-xxl bg-white p-0">
<!-- Spinner Start -->
    <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-grow text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
<!-- Spinner End -->
    <div class="icon-bar">
      <a class="active" href="/"><i class="fa fa-home"></i></a>
      <h1 style="color: white; ">Your Result </h1>

    </div>
 <!-- Navbar & Hero Start -->
 <div class="container-xxl position-relative p-0">
  <nav style="height: 8%; " class="navbar navbar-expand-lg navbar-light px-sm-5 px-lg-5 py-3 py-lg-0">
      <a href="" class="navbar-brand p-0">
          <h1 class="m-0">Recommendation System</h1>
          <!-- <img src="img/logo.png" alt="Logo"> -->
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
          <span class="fa fa-bars"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
          <div class="navbar-nav mx-auto py-0">
              <!-- <a href="index.html" class="nav-item nav-link active">Home</a>
              <a href="about.html" class="nav-item nav-link">About</a>
              <a href="service.html" class="nav-item nav-link">Service</a>
              <a href="project.html" class="nav-item nav-link">Project</a>

              <a href="contact.html" class="nav-item nav-link">Contact</a> -->
          </div>
          <!-- <a href="" class="btn rounded-pill py-2 px-4 ms-3 d-none d-lg-block">Get Started</a> -->
      </div>
  </nav>
 </div>
   <br>
   <br><br><br>
   <p class="text-center mb-5">Here are the top job recommendations based on your skills and experience, generated by our powerful machine learning algorithms.</p>
    <div class="container">
      <div class="form-container">
        <form id="job-select-form" method="POST" enctype="multipart/form-data">
          <input type="hidden" id="cv-skills-input" name="cv_skills" value="{{ cv_skills }}">

          <div class="input-container">
            <label for="job-select">Select a job:</label>
            <select id="job-select" name="job">
              {% for index, row in best_jobs.iterrows() %}
              <option value="{{ row['Job_title'] }}">{{ row['Job_title'] }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="input-container">
            <input type="radio" name="action" value="cv-skills" id="cv-skills" checked>
            <label for="cv-skills">Get CV Skills</label>
          </div>

          <div class="input-container">
            <input type="radio" name="action" value="similar-jobs" id="similar-jobs">
            <label for="similar-jobs">Get Similar Jobs</label>
          </div>

          <button class="btn btn-secondary py-sm-3 px-sm-5 rounded-pill me-3 animated slideInLeft" type="submit">Submit</button>
        </form>
      </div>

      <div class="bar-container">
        <img src="{{ url_for('static', filename=plot_path) }}" alt="Bar plot" class="bar">
      </div>
    </div>

    <div id="similar-jobs"></div>

    <div id="matching-cv-skills"></div>


      </div>

    </div>

     <!-- Footer Start -->
     <div class="container-fluid bg-primary text-light footer wow fadeIn" data-wow-delay="0.1s">

      <div class="container px-lg-5">
          <div class="copyright">
              <div class="row">
                  <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                      &copy; <a class="border-bottom" href="#">Job Recommendations System</a>, All Right Reserved.

                      <!--/*** This templates is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the templates without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
                      Designed By <a class="border-bottom" href="https://htmlcodex.com">HTML Codex</a>
                  </div>
                  <div class="col-md-6 text-center text-md-end">
                      <div style="margin-left: 70%;" class="footer-menu">
                          <a href="/">Return To Home</a>
                          <!-- <a href="">Cookies</a>
                           -->
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
  <!-- Footer End -->
 </div>
 <script>
  // Add event listener for form submission
  document.getElementById('job-select-form').addEventListener('submit', function(event) {
    event.preventDefault();  // Prevent default form submission behavior

    var formData = new FormData(event.target);  // Create a new FormData object from the form data

    // Get the value of the cv_skills input field
    var cvSkillsInput = document.getElementById('cv-skills-input');
    var cvSkillsValue = cvSkillsInput.value;

    // Add the cv_skills value to the FormData object
    formData.append('cv_skills', cvSkillsValue);

    // Get the selected job title index from the form data
    var jobTitleIndex = document.getElementById('job-select').selectedIndex;

    // Get the selected job title and action from the form data
    var jobTitle = formData.get('job_title');
    var action = formData.get('action');

    // Send an AJAX request to the server to handle the form submission
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
      if (xhr.readyState === XMLHttpRequest.DONE) {
        if (xhr.status === 200) {
          // Handle the response from the server
          var response = xhr.responseText;
          console.log(response);

          // Display the results on the page
          if (formData.get('action') === 'similar-jobs') {
            document.getElementById('similar-jobs').innerHTML = response;
          } else if(formData.get('action') === 'cv-skills'){
            document.getElementById('matching-cv-skills').innerHTML = response;
          }
        } else {
          console.log('Error: ' + xhr.status);
        }
      }
    };
    xhr.open('POST', '/recommendation_system_feature', true);
    xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    // Send the AJAX request to the server with the correct form data
    xhr.send('job=' + encodeURIComponent(jobTitle) + '&jobTitleIndex=' + encodeURIComponent(jobTitleIndex.toString()) + '&action=' + encodeURIComponent(action) + '&cv_skills=' + encodeURIComponent(cvSkillsValue));
  });
</script>
    <!-- JavaScript Libraries -->
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
	<script src="{{ url_for('serve_static', path='lib/wow/wow.min.js') }}"></script>
	<script src="{{ url_for('serve_static', path='lib/easing/easing.min.js') }}"></script>
	<script src="{{ url_for('serve_static', path='lib/waypoints/waypoints.min.js') }}"></script>
	<script src="{{ url_for('serve_static', path='lib/counterup/counterup.min.js') }}"></script>
	<script src="{{ url_for('serve_static', path='lib/owlcarousel/owl.carousel.min.js') }}"></script>
	<script src="{{ url_for('serve_static', path='lib/isotope/isotope.pkgd.min.js') }}"></script>
	<script src="{{ url_for('serve_static', path='lib/lightbox/js/lightbox.min.js') }}"></script>

	<!-- Template Javascript -->
	<script src="{{ url_for('serve_static', path='js/main.js') }}"></script>

</body>
</html>
